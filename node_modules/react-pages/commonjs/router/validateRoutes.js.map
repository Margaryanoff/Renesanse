{"version":3,"file":"validateRoutes.js","names":["validateRoutes","routes","length","Error","Component","getComponent","Array","isArray","validateThatMetaOrLoadAreOnlyAtLeafRoutes","parentRoutes","route","children","validateHasNoProperty","propertyName","throwError","type","getRoutePath","concat"],"sources":["../../lib/router/validateRoutes.js"],"sourcesContent":["import getRoutePath from './getRoutePath.js'\r\n\r\nexport default function validateRoutes(routes) {\r\n\tif (routes.length !== 1) {\r\n\t\tthrow new Error('[react-pages] `routes` must be an array with one element')\r\n\t}\r\n\r\n\tif (!(routes[0].Component || routes[0].getComponent)) {\r\n\t\tthrow new Error('[react-pages] Root route must have a `Component` or a `getComponent`')\r\n\t}\r\n\r\n\t// If `routes` is an array then it means that the routes configuration\r\n\t// is a JSON one rather than a React Element one.\r\n\t// In older versions of `react-router` they used to configure routes\r\n\t// not as JSON objects but as React Elements (weird).\r\n\tif (!Array.isArray(routes)) {\r\n\t\tthrow new Error('[react-pages] `routes` must be a JSON structure')\r\n\t}\r\n\r\n\t// The `if` block below validated that there's no `getData` function\r\n\t// already associated to the top-level route in the chain.\r\n\t// That `if` block was eventually commented out. The reason is that\r\n\t// if there's an error on client side in `setUpAndRender()`\r\n\t// then `setUpAndRender()` gets called again in order to render the error page.\r\n\t// And in that case `getData` will already be set on `routes[0]`\r\n\t// and the `if` condition would be valid resulting in throwing the error.\r\n\t// So throwing the error was commented out.\r\n\t// if (routes[0].getData) {\r\n\t// \tthrow new Error('[react-pages] `getData` found on the root route')\r\n\t// }\r\n\r\n\t// Validate that `.load()` or `.meta()` functions could only be defined\r\n\t// at \"root\" or \"leaf\" route `Component`s (page components).\r\n\tvalidateThatMetaOrLoadAreOnlyAtLeafRoutes(routes)\r\n}\r\n\r\nfunction validateThatMetaOrLoadAreOnlyAtLeafRoutes(routes, parentRoutes = []) {\r\n\tfor (const route of routes) {\r\n\t\tif (route.children) {\r\n\t\t\t// This is a non-\"leaf\" route.\r\n\r\n\t\t\t// If it's a non-root route.\r\n\t\t\tif (parentRoutes.length > 0) {\r\n\t\t\t\tconst validateHasNoProperty = (propertyName) => {\r\n\t\t\t\t\tconst throwError = (type) => {\r\n\t\t\t\t\t\tthrow new Error(`[react-pages] Only root or leaf route${type === 'component' ? ' Component' : ''}s could have a \\`${propertyName}\\` parameter. A non-leaf route${type === 'component' ? ' Component' : ''} was found having a \\`${propertyName}\\` parameter for route \"${getRoutePath(parentRoutes.concat(route))}\"`)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (route.Component) {\r\n\t\t\t\t\t\tif (route.Component[propertyName]) {\r\n\t\t\t\t\t\t\tthrowError('component')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (route.getComponent) {\r\n\t\t\t\t\t\tif (route[propertyName]) {\r\n\t\t\t\t\t\t\tthrowError('route')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvalidateHasNoProperty('load')\r\n\t\t\t\tvalidateHasNoProperty('meta')\r\n\t\t\t}\r\n\r\n\t\t\t// Recurse into child routes.\r\n\t\t\tvalidateThatMetaOrLoadAreOnlyAtLeafRoutes(route.children, parentRoutes.concat([route]))\r\n\t\t} else {\r\n\t\t\t// This is a \"leaf\" route.\r\n\t\t\tif (!(route.Component || route.getComponent)) {\r\n\t\t\t\tthrow new Error(`[react-pages] Route \"${getRoutePath(parentRoutes.concat(route))}\" must have a \\`Component\\` or a \\`getComponent\\``)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}"],"mappings":";;;;;;AAAA;AAA4C;AAAA;AAAA;AAAA;AAE7B,SAASA,cAAc,CAACC,MAAM,EAAE;EAC9C,IAAIA,MAAM,CAACC,MAAM,KAAK,CAAC,EAAE;IACxB,MAAM,IAAIC,KAAK,CAAC,0DAA0D,CAAC;EAC5E;EAEA,IAAI,EAAEF,MAAM,CAAC,CAAC,CAAC,CAACG,SAAS,IAAIH,MAAM,CAAC,CAAC,CAAC,CAACI,YAAY,CAAC,EAAE;IACrD,MAAM,IAAIF,KAAK,CAAC,sEAAsE,CAAC;EACxF;;EAEA;EACA;EACA;EACA;EACA,IAAI,CAACG,KAAK,CAACC,OAAO,CAACN,MAAM,CAAC,EAAE;IAC3B,MAAM,IAAIE,KAAK,CAAC,iDAAiD,CAAC;EACnE;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACAK,yCAAyC,CAACP,MAAM,CAAC;AAClD;AAEA,SAASO,yCAAyC,CAACP,MAAM,EAAqB;EAAA,IAAnBQ,YAAY,uEAAG,EAAE;EAAA,2CACvDR,MAAM;IAAA;EAAA;IAAA,6BAAE;MAAA,IAAjBS,KAAK;MACf,IAAIA,KAAK,CAACC,QAAQ,EAAE;QACnB;;QAEA;QACA,IAAIF,YAAY,CAACP,MAAM,GAAG,CAAC,EAAE;UAC5B,IAAMU,qBAAqB,GAAG,SAAxBA,qBAAqB,CAAIC,YAAY,EAAK;YAC/C,IAAMC,UAAU,GAAG,SAAbA,UAAU,CAAIC,IAAI,EAAK;cAC5B,MAAM,IAAIZ,KAAK,gDAAyCY,IAAI,KAAK,WAAW,GAAG,YAAY,GAAG,EAAE,6BAAoBF,YAAY,0CAAiCE,IAAI,KAAK,WAAW,GAAG,YAAY,GAAG,EAAE,kCAAyBF,YAAY,qCAA2B,IAAAG,wBAAY,EAACP,YAAY,CAACQ,MAAM,CAACP,KAAK,CAAC,CAAC,QAAI;YACtT,CAAC;YACD,IAAIA,KAAK,CAACN,SAAS,EAAE;cACpB,IAAIM,KAAK,CAACN,SAAS,CAACS,YAAY,CAAC,EAAE;gBAClCC,UAAU,CAAC,WAAW,CAAC;cACxB;YACD,CAAC,MAAM,IAAIJ,KAAK,CAACL,YAAY,EAAE;cAC9B,IAAIK,KAAK,CAACG,YAAY,CAAC,EAAE;gBACxBC,UAAU,CAAC,OAAO,CAAC;cACpB;YACD;UACD,CAAC;UAEDF,qBAAqB,CAAC,MAAM,CAAC;UAC7BA,qBAAqB,CAAC,MAAM,CAAC;QAC9B;;QAEA;QACAJ,yCAAyC,CAACE,KAAK,CAACC,QAAQ,EAAEF,YAAY,CAACQ,MAAM,CAAC,CAACP,KAAK,CAAC,CAAC,CAAC;MACxF,CAAC,MAAM;QACN;QACA,IAAI,EAAEA,KAAK,CAACN,SAAS,IAAIM,KAAK,CAACL,YAAY,CAAC,EAAE;UAC7C,MAAM,IAAIF,KAAK,iCAAyB,IAAAa,wBAAY,EAACP,YAAY,CAACQ,MAAM,CAACP,KAAK,CAAC,CAAC,oDAAoD;QACrI;MACD;IACD,CAAC;IAjCD;MAAA;IAAA;EAiCC;IAAA;EAAA;IAAA;EAAA;AACF"}