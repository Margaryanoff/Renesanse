{"version":3,"file":"index.js","names":["createRouterStoreEnhancers","routes","createHistoryProtocol","options","middlewares","queryMiddleware","basename","push","createBasenameMiddleware","createHistoryEnhancer","protocol","createMatchEnhancer","Matcher","matchRoutes","store","getStoreRenderArgs","resolver","matchContext","dispatch","getState","then","renderArgs","error","getRoutesByPath","routeIndices","matchedRoutes","i","children","getMatch","state","found","match","getMatchedRoutes","getMatchedRoutesIndices","getMatchedRoutesParams","routeParams","getRouteParams","params","getMatchedLocation","location","getMatchThatHasBeenLoaded","resolvedMatch","getMatchedLocationThatHasBeenLoaded","getRoutePath","filter","route","path","map","replace","join"],"sources":["../../lib/router/index.js"],"sourcesContent":["// `@catamphetamine/found` is a fork of `found` with some changes:\r\n// * `redux` and `react-redux` are `peerDependencies` instead of `dependencies`.\r\n// * `farce` was replaced with `@catamphetamine/farce`.\r\n// * Fixed a bug when `found` ignores all navigation actions until its `componentDidMount()` is called.\r\nexport {\r\n\tfoundReducer,\r\n\tRedirect,\r\n\tuseRouter,\r\n\tRedirectException\r\n} from '@catamphetamine/found'\r\n\r\n// `@catamphetamine/found` is a fork of `found` with some changes:\r\n// * `redux` and `react-redux` are `peerDependencies` instead of `dependencies`.\r\n// * `farce` was replaced with `@catamphetamine/farce` (added `location.origin`)\r\nimport {\r\n\tcreateMatchEnhancer,\r\n\tMatcher,\r\n\tgetStoreRenderArgs,\r\n\tHttpError,\r\n\tresolver\r\n} from '@catamphetamine/found'\r\n\r\nimport {\r\n\tcreateHistoryEnhancer,\r\n\tcreateBasenameMiddleware,\r\n\tqueryMiddleware\r\n} from '@catamphetamine/farce'\r\n\r\nexport function createRouterStoreEnhancers(routes, createHistoryProtocol, options = {}) {\r\n\tconst middlewares = [\r\n\t\t// Parses `location.search` string into `location.query` object.\r\n\t\tqueryMiddleware\r\n\t]\r\n\tif (options.basename) {\r\n\t\tmiddlewares.push(createBasenameMiddleware({\r\n\t\t\tbasename: options.basename\r\n\t\t}))\r\n\t}\r\n\treturn [\r\n\t\tcreateHistoryEnhancer({\r\n\t\t\tprotocol: createHistoryProtocol(),\r\n\t\t\tmiddlewares\r\n\t\t}),\r\n\t\tcreateMatchEnhancer(\r\n\t\t\t// new Matcher(hotRouteConfig(routes))\r\n\t\t\tnew Matcher(routes)\r\n\t\t)\r\n\t]\r\n}\r\n\r\nexport function matchRoutes(store) {\r\n\treturn getStoreRenderArgs({\r\n\t\tstore,\r\n\t\tresolver,\r\n\t\tmatchContext: {\r\n\t\t\tdispatch: store.dispatch,\r\n\t\t\tgetState: store.getState\r\n\t\t}\r\n\t})\r\n\t.then((renderArgs) => {\r\n\t\tif (renderArgs.error) {\r\n\t\t\tthrow renderArgs.error\r\n\t\t}\r\n\t\treturn renderArgs\r\n\t})\r\n}\r\n\r\nexport function getRoutesByPath(routeIndices, routes) {\r\n\tconst matchedRoutes = []\r\n\tfor (const i of routeIndices) {\r\n\t\tmatchedRoutes.push(routes[i])\r\n\t\troutes = routes[i].children\r\n\t}\r\n\treturn matchedRoutes\r\n}\r\n\r\nexport function getMatch(state) {\r\n\treturn state.found.match\r\n}\r\n\r\nexport function getMatchedRoutes(state, routes) {\r\n\treturn getRoutesByPath(getMatch(state).routeIndices, routes)\r\n}\r\n\r\nexport function getMatchedRoutesIndices(state) {\r\n\treturn getMatch(state).routeIndices\r\n}\r\n\r\n// A URL can consist of several \"routes\": a parent route + possible sub-routes.\r\n// \"Matched route params\" are just this particular route's params for a given URL.\r\n// All routes' params are the combined params for all matched routes for a given URL.\r\n//\r\n// Example:\r\n//\r\n// const routes = [{\r\n//   path: ':foo',\r\n//   children: [{\r\n//     path: ':bar'\r\n//   }]\r\n// }]\r\n//\r\n// const location = {\r\n//   pathname: '/a/b'\r\n// }\r\n//\r\n// const routeParams = [\r\n// \t{ foo: 'a' },\r\n// \t{ bar: 'b' }\r\n// ]\r\n//\r\n// const params = {\r\n//   foo: 'a',\r\n//   bar: 'b'\r\n// }\r\n//\r\nexport function getMatchedRoutesParams(state) {\r\n\treturn getMatch(state).routeParams\r\n}\r\n\r\nexport function getRouteParams(state) {\r\n\treturn getMatch(state).params\r\n}\r\n\r\nexport function getMatchedLocation(state) {\r\n\treturn getMatch(state).location\r\n}\r\n\r\nexport function getMatchThatHasBeenLoaded(state) {\r\n\treturn state.found.resolvedMatch\r\n}\r\n\r\nexport function getMatchedLocationThatHasBeenLoaded(state) {\r\n\treturn getMatchThatHasBeenLoaded(state) && getMatchThatHasBeenLoaded(state).location\r\n}\r\n\r\n// Returns a complete route path for matched routes chain.\r\n// E.g. returns \"/user/:user_id/post/:post_id\"\r\n// for matched URL \"/user/1/post/123?key=value\".\r\nexport function getRoutePath(routes)\r\n{\r\n\treturn routes\r\n\t\t// Select routes having `path` React property set.\r\n\t\t.filter(route => route.path)\r\n\t\t// Trim leading and trailing slashes (`/`)\r\n\t\t// from each route `path` React property.\r\n\t\t.map(route => route.path.replace(/^\\//, '').replace(/\\/$/, ''))\r\n\t\t// Join route `path`s with slashes (`/`).\r\n\t\t.join('/') || '/'\r\n}"],"mappings":"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"}