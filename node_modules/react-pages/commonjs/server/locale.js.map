{"version":3,"file":"locale.js","names":["getPreferredLocales","headers","getLocalesFromHeader","accepts","regExp","locales","match","length","exec","locale","toUpperCase","push"],"sources":["../../lib/server/locale.js"],"sourcesContent":["// Based on `koa-locale`\r\n// https://github.com/koa-modules/locale/blob/master/index.js\r\nexport function getPreferredLocales(headers) {\r\n\treturn getLocalesFromHeader(headers['accept-language'])\r\n}\r\n\r\n// // From query, `locale=en`\r\n// function getLocaleFromQuery(query) {\r\n// \treturn query.locale\r\n// }\r\n\r\n// Parses locales from `Accept-Language` HTTP header.\r\n// Copy-pasted from somewhere on stackoverflow.com.\r\nfunction getLocalesFromHeader(accepts = '') {\r\n\t// E.g. \"Accept-Language\": \"da, en-gb;q=0.8, en;q=0.7\".\r\n\t// Global regular expressions are stateful so it's recreated on each function call.\r\n\tconst regExp = /(^|,\\s*)(?:([a-z]{1,8})(-[A-z]{1,8})?)/g\r\n\tconst locales = []\r\n\tlet match\r\n\t// Terminates at 10 preferred locales max.\r\n\t// (to protect from a possible overflow attack)\r\n\twhile (locales.length < 10 && (match = regExp.exec(accepts))) {\r\n\t\tlet locale = match[2]\r\n\t\tif (match.length > 3 && match[3]) {\r\n\t\t\tlocale += match[3].toUpperCase()\r\n\t\t}\r\n\t\tlocales.push(locale)\r\n\t}\r\n\treturn locales\r\n}\r\n\r\n// // From cookie, e.g. `locale=zh-CN`\r\n// function getLocaleFromCookie(cookie) {\r\n// \treturn cookie\r\n// }"],"mappings":";;;;;;AAAA;AACA;AACO,SAASA,mBAAmB,CAACC,OAAO,EAAE;EAC5C,OAAOC,oBAAoB,CAACD,OAAO,CAAC,iBAAiB,CAAC,CAAC;AACxD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAASC,oBAAoB,GAAe;EAAA,IAAdC,OAAO,uEAAG,EAAE;EACzC;EACA;EACA,IAAMC,MAAM,GAAG,yCAAyC;EACxD,IAAMC,OAAO,GAAG,EAAE;EAClB,IAAIC,KAAK;EACT;EACA;EACA,OAAOD,OAAO,CAACE,MAAM,GAAG,EAAE,KAAKD,KAAK,GAAGF,MAAM,CAACI,IAAI,CAACL,OAAO,CAAC,CAAC,EAAE;IAC7D,IAAIM,MAAM,GAAGH,KAAK,CAAC,CAAC,CAAC;IACrB,IAAIA,KAAK,CAACC,MAAM,GAAG,CAAC,IAAID,KAAK,CAAC,CAAC,CAAC,EAAE;MACjCG,MAAM,IAAIH,KAAK,CAAC,CAAC,CAAC,CAACI,WAAW,EAAE;IACjC;IACAL,OAAO,CAACM,IAAI,CAACF,MAAM,CAAC;EACrB;EACA,OAAOJ,OAAO;AACf;;AAEA;AACA;AACA;AACA"}