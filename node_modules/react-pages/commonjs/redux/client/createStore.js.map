{"version":3,"file":"createStore.js","names":["createStore","settings","options","stash","devtools","stats","onBeforeNavigate","onNavigationFinished","onPageRendered","onStoreCreated","getLoadContext","normalizeSettings","store","httpClient","createHttpClient","fetch","window","_ReactPages_HttpClient","initialState","getFromContext","createStore_","createHistoryProtocol","getCookie","context","dispatch","action"],"sources":["../../../lib/redux/client/createStore.js"],"sourcesContent":["import createHistoryProtocol from '../../router/client/createHistoryProtocol.js'\r\nimport createStore_ from '../store.js'\r\nimport createHttpClient from '../HttpClient.js'\r\nimport normalizeSettings from '../normalize.js'\r\nimport { getCookie } from '../../client/cookies.js'\r\nimport { getFromContext } from '../../context.js'\r\n\r\n/**\r\n * Creates a Redux store.\r\n * @param  {object} settings\r\n * @param  {object} [options]\r\n * @return {object} store\r\n */\r\nexport default function createStore(settings, options = {}, { stash }) {\r\n\tconst {\r\n\t\tdevtools,\r\n\t\tstats,\r\n\t\tonBeforeNavigate,\r\n\t\tonPageRendered: onNavigationFinished,\r\n\t\tonStoreCreated,\r\n\t\tgetLoadContext\r\n\t} = options\r\n\r\n\tsettings = normalizeSettings(settings)\r\n\r\n\t// Redux store.\r\n\t// This variable is used in `httpClient`,\r\n\t// that's why it's declared at the top.\r\n\tlet store\r\n\r\n\t// Create HTTP client (Redux action creator `http` utility)\r\n\tconst httpClient = createHttpClient(settings, () => store, { fetch })\r\n\r\n\t// Store the reference to `httpClient` in `window` for WebSocket message handlers.\r\n\t// WebSocket handlers only run on the client side, so it's fine storing the `httpClient`\r\n\t// in `window`.\r\n\twindow._ReactPages_HttpClient = httpClient\r\n\r\n\tconst initialState = getFromContext('App/ReduxStateServerSideSnapshot')\r\n\r\n\t// Create Redux store\r\n\tstore = createStore_({\r\n\t\tinitialState,\r\n\t\tcreateHistoryProtocol,\r\n\t\thttpClient,\r\n\t\tstash,\r\n\t\tsettings,\r\n\t\toptions: {\r\n\t\t\tdevtools,\r\n\t\t\tstats,\r\n\t\t\tonBeforeNavigate,\r\n\t\t\tonNavigationFinished,\r\n\t\t\tgetCookie,\r\n\t\t\tcontext: getLoadContext && getLoadContext({\r\n\t\t\t\tdispatch: (action) => store.dispatch(action)\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n\r\n\t// `onStoreCreated(store)` is called here.\r\n\t//\r\n\t// For example, client-side-only applications\r\n\t// may capture this `store` as `window.store`\r\n\t// to call `bindActionCreators()` for all actions (globally).\r\n\t//\r\n\t// onStoreCreated: store => window.store = store\r\n\t//\r\n\t// import { bindActionCreators } from 'redux'\r\n\t// import actionCreators from './actions'\r\n\t// const boundActionCreators = bindActionCreators(actionCreators, window.store.dispatch)\r\n\t// export default boundActionCreators\r\n\t//\r\n\t// Not saying that this is even a \"good\" practice,\r\n\t// more like \"legacy code\", but still my employer\r\n\t// happened to have such binding, so I added this feature.\r\n  // Still this technique cuts down on a lot of redundant \"wiring\" code.\r\n  //\r\n\tif (onStoreCreated) {\r\n\t\tonStoreCreated(store)\r\n\t}\r\n\r\n\treturn store\r\n}"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAAiD;AAEjD;AACA;AACA;AACA;AACA;AACA;AACe,SAASA,WAAW,CAACC,QAAQ,EAA2B;EAAA,IAAzBC,OAAO,uEAAG,CAAC,CAAC;EAAA;IAAIC,KAAK,QAALA,KAAK;EAClE,IACCC,QAAQ,GAMLF,OAAO,CANVE,QAAQ;IACRC,KAAK,GAKFH,OAAO,CALVG,KAAK;IACLC,gBAAgB,GAIbJ,OAAO,CAJVI,gBAAgB;IACAC,oBAAoB,GAGjCL,OAAO,CAHVM,cAAc;IACdC,cAAc,GAEXP,OAAO,CAFVO,cAAc;IACdC,cAAc,GACXR,OAAO,CADVQ,cAAc;EAGfT,QAAQ,GAAG,IAAAU,qBAAiB,EAACV,QAAQ,CAAC;;EAEtC;EACA;EACA;EACA,IAAIW,KAAK;;EAET;EACA,IAAMC,UAAU,GAAG,IAAAC,sBAAgB,EAACb,QAAQ,EAAE;IAAA,OAAMW,KAAK;EAAA,GAAE;IAAEG,KAAK,EAALA;EAAM,CAAC,CAAC;;EAErE;EACA;EACA;EACAC,MAAM,CAACC,sBAAsB,GAAGJ,UAAU;EAE1C,IAAMK,YAAY,GAAG,IAAAC,uBAAc,EAAC,kCAAkC,CAAC;;EAEvE;EACAP,KAAK,GAAG,IAAAQ,iBAAY,EAAC;IACpBF,YAAY,EAAZA,YAAY;IACZG,qBAAqB,EAArBA,iCAAqB;IACrBR,UAAU,EAAVA,UAAU;IACVV,KAAK,EAALA,KAAK;IACLF,QAAQ,EAARA,QAAQ;IACRC,OAAO,EAAE;MACRE,QAAQ,EAARA,QAAQ;MACRC,KAAK,EAALA,KAAK;MACLC,gBAAgB,EAAhBA,gBAAgB;MAChBC,oBAAoB,EAApBA,oBAAoB;MACpBe,SAAS,EAATA,kBAAS;MACTC,OAAO,EAAEb,cAAc,IAAIA,cAAc,CAAC;QACzCc,QAAQ,EAAE,kBAACC,MAAM;UAAA,OAAKb,KAAK,CAACY,QAAQ,CAACC,MAAM,CAAC;QAAA;MAC7C,CAAC;IACF;EACD,CAAC,CAAC;;EAEF;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACC;EACA;EACD,IAAIhB,cAAc,EAAE;IACnBA,cAAc,CAACG,KAAK,CAAC;EACtB;EAEA,OAAOA,KAAK;AACb"}