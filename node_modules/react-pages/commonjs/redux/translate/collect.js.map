{"version":3,"file":"collect.js","names":["TRANSLATE_LOCALES_PROPERTY","collectTranslations","components","routes","routeIndices","codeSplit","locale","dispatch","forEach","route","i","_key","slice","join","translations","map","component","path","getTranslation","filter","_","length","Promise","all","_ref","then","translation"],"sources":["../../../lib/redux/translate/collect.js"],"sourcesContent":["const TRANSLATE_LOCALES_PROPERTY  = '__translation__'\r\n\r\nexport default function collectTranslations(components, routes, routeIndices, codeSplit, locale, dispatch) {\r\n\t// Set the `_key` for each route.\r\n\t// Each page component gets `route` property\r\n\t// from which it can get the `_key`\r\n\t// and using that `_key` it can get the\r\n\t// translation data from Redux state.\r\n\troutes.forEach((route, i) => {\r\n\t\troute._key = routeIndices.slice(0, i + 1).join('/')\r\n\t})\r\n\tconst translations = components\r\n\t\t.map((component, i) => ({\r\n\t\t\tpath: routes[i]._key,\r\n\t\t\tgetTranslation: component[TRANSLATE_LOCALES_PROPERTY] && component[TRANSLATE_LOCALES_PROPERTY][locale]\r\n\t\t}))\r\n\t\t.filter(_ => _.getTranslation)\r\n\tif (translations.length > 0) {\r\n\t\treturn () => Promise.all(translations.map(({ path, getTranslation }) => {\r\n\t\t\treturn getTranslation().then((translation) => dispatch('@@react-pages/translation', {\r\n\t\t\t\tpath,\r\n\t\t\t\ttranslation\r\n\t\t\t}))\r\n\t\t}))\r\n\t}\r\n}"],"mappings":";;;;;;AAAA,IAAMA,0BAA0B,GAAI,iBAAiB;AAEtC,SAASC,mBAAmBA,CAACC,UAAU,EAAEC,MAAM,EAAEC,YAAY,EAAEC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,EAAE;EAC1G;EACA;EACA;EACA;EACA;EACAJ,MAAM,CAACK,OAAO,CAAC,UAACC,KAAK,EAAEC,CAAC,EAAK;IAC5BD,KAAK,CAACE,IAAI,GAAGP,YAAY,CAACQ,KAAK,CAAC,CAAC,EAAEF,CAAC,GAAG,CAAC,CAAC,CAACG,IAAI,CAAC,GAAG,CAAC;EACpD,CAAC,CAAC;EACF,IAAMC,YAAY,GAAGZ,UAAU,CAC7Ba,GAAG,CAAC,UAACC,SAAS,EAAEN,CAAC;IAAA,OAAM;MACvBO,IAAI,EAAEd,MAAM,CAACO,CAAC,CAAC,CAACC,IAAI;MACpBO,cAAc,EAAEF,SAAS,CAAChB,0BAA0B,CAAC,IAAIgB,SAAS,CAAChB,0BAA0B,CAAC,CAACM,MAAM;IACtG,CAAC;EAAA,CAAC,CAAC,CACFa,MAAM,CAAC,UAAAC,CAAC;IAAA,OAAIA,CAAC,CAACF,cAAc;EAAA,EAAC;EAC/B,IAAIJ,YAAY,CAACO,MAAM,GAAG,CAAC,EAAE;IAC5B,OAAO;MAAA,OAAMC,OAAO,CAACC,GAAG,CAACT,YAAY,CAACC,GAAG,CAAC,UAAAS,IAAA,EAA8B;QAAA,IAA3BP,IAAI,GAAAO,IAAA,CAAJP,IAAI;UAAEC,cAAc,GAAAM,IAAA,CAAdN,cAAc;QAChE,OAAOA,cAAc,EAAE,CAACO,IAAI,CAAC,UAACC,WAAW;UAAA,OAAKnB,QAAQ,CAAC,2BAA2B,EAAE;YACnFU,IAAI,EAAJA,IAAI;YACJS,WAAW,EAAXA;UACD,CAAC,CAAC;QAAA,EAAC;MACJ,CAAC,CAAC,CAAC;IAAA;EACJ;AACD"}